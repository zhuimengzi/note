## JavaScript插件开发——全屏切换（实现）

在上一节中我们对全屏切换进行了分析，这一节我们将用代码去实现。

#### 以什么样的方式提供给用户使用

上节还漏掉个事，就是我们要以什么样的方式提供给用户使用，目前我所知道的有两种，一种是通过给元素加自定义属性，还有一种是写一段javascript，~~我们这个全屏切换用自定义属性就行了，因为没有必要让用户再写一段javascript。~~由于现在很多人在页面中都用了一些框架比如Vue，这样的话就会出现一个问题，如果我们过早的去获取元素获取到的就有可能不是正确的，假如用户写了下面这样的一段代码

```html
<section v-if="false" data-page></section>
<section v-if="true" data-page></section>
```

如果我们在Vue渲染之前去获取元素获取到的就是两个，在Vue渲染之后去获取就是获取到的一个，用户也是希望我们在Vue渲染之后再进行初始化的。但由于我们是无法知道Vue是否渲染完毕的，而且用户也不一定是使用的Vue，因此初始化必须交给用户来操作。

#### 插件代码的基本结构

```javascript
;(function(window,document){
    function PageSwitch(){
        this.__init__();
    }
    PageSwitch.prototype = {
        constructor:PageSwitch,
        __init__:function(){

        }
    };
    window.PageSwitch = PageSwitch;
}(window,document));
```

一般我会在代码的开头加一个分号，这样如果用户进行代码合并就不会因为用户的代码而影响我的插件，如果你没有听懂可以看一下这篇文章[走进javascript——不起眼的基础，值和分号](http://www.cnblogs.com/pssp/p/6361070.html#分号)

我们把要写的代码，封闭到一个自执行函数中，这样可以减少变量污染，但由于函数外部无法访问函数内部的变量和函数，因此我们需要将暴露给用户使用的接口暴露到全局，浏览器端我们一般放在window属性上。

如果某些api不需要用户去操作则用`__xx__`来表示。[javascript 以 "__" 开头的方法名，代表着什么？](https://www.zhihu.com/question/21425422)

手动指定constructor [走进javascript——类型](http://www.cnblogs.com/pssp/p/6815348.html#通过constructor属性来判断对象类型是个好方法)

#### 编写代码

在编写代码之前我们再来看一下上一节中我们提到的几个问题：

- 既然是上下页面切换，那么滑动多少才切换呢 
- 如果是第一张往下滑需要做特殊处理吗？最后一张呢？
- 可以手动定位到某一屏？如果可以我们应该如何处理动画 
- 支持连续滑屏？还是在某个时间范围内不允许
- 支持左右切换？
- 滑屏切换时给回调？

上下切换和左右切换是冲突的，因此如果我们需要同时实现这两种方案则需要暴露一个接口让用户进行选择。

对于可扩展的内容，我们也需要按照扩展的形式去实现。

