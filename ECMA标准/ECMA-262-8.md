### EcmaScript2018

介绍

此Ecma标准定义了ECMAScript 2018语言。这是ECMAScript语言规范的第九版。自1997年发行第一版以来，ECMAScript已经成为世界上应用最广泛的通用编程语言之一。最着名的是嵌入在Web浏览器中的语言，但也被广泛应用于服务器和嵌入式应用程序。

ECMAScript基于几种起始技术，最着名的是JavaScript（Netscape）和JScript（Microsoft）。该语言由Netscape的Brendan Eich发明，并首次出现在该公司的Navigator 2.0浏览器中。它已经出现在Netscape的所有后续浏览器和Microsoft Internet Explorer 3.0的所有浏览器中。

ECMAScript语言规范的制定始于1996年11月。该Ecma标准的第一版于1997年6月由Ecma大会通过。

该Ecma标准已被提交给ISO / IEC JTC 1，采用快速程序，1998年4月被批准为国际标准ISO / IEC 16262。1998年6月的Ecma大会批准了ECMA-262第二版保持与ISO / IEC 16262完全一致。第一版和第二版之间的变化本质上是编辑性的。

标准的第三版引入了强大的正则表达式，更好的字符串处理，新的控制语句，try / catch异常处理，错误的更严格的定义，数字输出的格式化以及预期未来语言增长的微小变化。 1999年12月，Ecma大会通过了第三版ECMAScript标准，2002年6月发布为ISO / IEC 16262：2002。

在第三版发布之后，ECMAScript与万维网结合大量采用，它已经成为所有Web浏览器支持的编程语言。做了大量的工作来开发第四版的ECMAScript。然而，这项工作尚未完成，并未作为ECMAScript第四版发布，但其中一些已纳入第六版的开发。

ECMAScript第五版（作为ECMA-262第5版出版）编纂了语言规范的实际解释，这些解释在浏览器实现中变得普遍，并增加了自第三版发布以来出现的新功能的支持。这些功能包括访问器属性，对象的反射创建和检查，属性属性的程序控制，附加数组操作功能，对JSON对象编码格式的支持以及提供增强的错误检查和程序安全性的严格模式。 2009年12月，Ecma大会通过了第五版。

第五版已经提交ISO / IEC JTC 1，采用快速通道程序，并被批准为国际标准ISO / IEC 16262：2011。 ECMAScript标准版本5.1包含了较少的更正，与ISO / IEC 16262：2011中的文本相同。 5.1版于2011年6月由Ecma大会通过。

第六版的重点发展始于2009年，因为第五版正在准备出版。不过，这之前是在1999年出版第三版之前进行了大量的实验和语言增强设计工作。从真实的意义上说，第六版的完成是十五年努力的结果。该增加的目标包括为大型应用程序，库创建和使用ECMAScript作为其他语言的编译目标提供更好的支持。其主要增强功能包括模块，类声明，词法块范围，迭代器和生成器，承诺异步编程，解构模式和适当的尾部调用。扩展了内建的ECMAScript库，以支持其他数据抽象，包括地图，集合和二进制数值数组，以及对字符串和正则表达式中的Unicode补充字符的额外支持。内置的也通过子类化扩展。第六版为常规，增量语言和图书馆增强提供了基础。第六版是2015年6月大会通过的。

该ECMAScript规范是Ecma TC39新的年度发布节奏和开放开发过程中首个发布的ECMAScript版本。源自ECMAScript 2015源文档的纯文本源文档作为完全在GitHub上进一步开发的基础。在这个标准开发的一年中，数百个提出的请求和问题被提交，代表成千上万的错误修复，编辑修复和其他改进。此外，开发了许多软件工具来帮助这一工作，包括Ecmarkup，Ecmarkdown和Grammarkdown。此规范还包括对新的求幂运算符的支持，并向称为include的Array.prototype添加了一种新方法。

代表许多组织的数十人在Ecma TC39中对本版本和以前版本的发展做出了非常重要的贡献。此外，一个充满活力的社区已经出现，支持TC39的ECMAScript努力。该社区已审查了许多草案，提交了数千个错误报告，执行实施实验，提供测试套件，并教育了全球开发人员社区关于ECMAScript。不幸的是，不可能识别和认可对这一努力作出贡献的每个人和组织。

艾伦Wirfs-Brock
ECMA-262，第6版项目编辑

布莱恩·泰尔森
ECMA-262，第七版项目编辑

1. 范围

本标准定义了ECMAScript 2018通用编程语言。

2. 一致性

ECMAScript的一致性实现必须提供和支持本规范中描述的所有类型，值，对象，属性，函数和程序语法和语义。

符合ECMAScript的实现必须解释符合最新版本的Unicode标准和ISO / IEC 10646的源文本输入。

ECMAScript的一致性实现提供了一个支持需要适应不同人类语言和国家使用的语言和文化惯例的程序的应用程序编程接口，必须实现最新版本的ECMA-402定义的界面，该界面与此兼容规范。

符合ECMAScript的实现可以提供除本说明书中描述的以外的其他类型，值，对象，属性和功能。特别地，符合ECMAScript的实现可以提供本说明书中未描述的属性以及用于这些属性的值，用于本说明书中描述的对象。

符合ECMAScript的实现可能支持本规范中未描述的程序和正则表达式语法。特别地，符合ECMAScript的实现可能支持使用本规范第11.6.2.2条列出的“未来保留字”的程序语法。

ECMAScript的一致性实现不能实现在第16.2节中被列为禁止扩展的任何扩展。

3. 规范性引用

以下引用的文档对于本文档的应用是必不可少的。 对于注日期的引用文件，只有引用的版本适用。 对于未注明日期的引用文件，引用文件的最新版本（包括任何修订）适用。

ISO / IEC 10646：2003：信息技术 - 通用多字节编码字符集（UCS）加修正案1：2005，修正2：2006，修订3：2008和修订4：2008，以及附加的修订和更正或后继

ECMA-402，ECMAScript 2015国际化API规范。
http://www.ecma-international.org/publications/standards/Ecma-402.htm

ECMA-404，JSON数据交换格式。
http://www.ecma-international.org/publications/standards/Ecma-404.htm

4. 概述

本节包含ECMAScript语言的非规范概述。

ECMAScript是一种面向对象的编程语言，用于在主机环境中执行计算和操纵计算对象。这里定义的ECMAScript不是计算自给自足的;实际上，在本说明书中没有规定外部数据的输入或计算结果的输出。相反，预期ECMAScript程序的计算环境不仅将提供本说明书中描述的对象和其他设施，还将提供特定的环境特定对象，其描述和行为超出了本规范的范围，除了指出它们可以提供可以访问的某些属性和可以从ECMAScript程序调用的某些功能。

ECMAScript最初设计用作脚本语言，但已被广泛用作通用编程语言。脚本语言是一种用于操纵，定制和自动化现有系统的设施的编程语言。在这样的系统中，通过用户界面已经可以使用有用的功能，并且脚本语言是将该功能暴露给程序控制的机制。以这种方式，现有系统被称为提供对象和设施的主机环境，从而完成了脚本语言的功能。脚本语言专门用于专业程序员和非专业程序员。

ECMAScript最初设计为Web脚本语言，提供了一种在浏览器中激活Web页面的机制，并将其作为基于Web的客户端 - 服务器架构的一部分执行服务器计算。 ECMAScript现在用于为各种主机环境提供核心脚本功能。因此，除了任何特定的主机环境之外，本文档还规定了核心语言。

ECMAScript使用已经超出了简单的脚本，现在它已经用于许多不同环境和规模的全面的编程任务。随着ECMAScript的使用不断扩大，其功能和设施也得到了扩展。 ECMAScript现在是一个功能齐全的通用编程语言。

ECMAScript的一些设施类似于其他编程语言中使用的设备;特别是C，Java™，Self和Scheme，如下所述：

ISO / IEC 9899：1996，编程语言 - C.

戈斯林，詹姆斯，比尔·乔伊和Guy Steele。 Java™语言规范。 Addison Wesley Publishing Co.，1996。

Ungar，David和Smith，Randall B. Self：简单的力量。 OOPSLA '87 Conference Proceedings，pp.227-241，Orlando，FL，1987年10月。

IEEE标准的方案编程语言。 IEEE Std 1178-1990。

4.1 Web脚本

Web浏览器为客户端计算提供ECMAScript主机环境，包括例如表示窗口，菜单，弹出窗口，对话框，文本区域，锚点，框架，历史记录，Cookie和输入/输出的对象。此外，主机环境提供了一种将脚本代码附加到诸如焦点改变，页面和图像加载，卸载，错误和中止，选择，表单提交和鼠标动作等事件的手段。脚本代码出现在HTML中，显示的页面是用户界面元素和固定和计算的文本和图像的组合。脚本代码对用户交互无反应，不需要主程序。

Web服务器为服务器端计算提供不同的主机环境，包括表示请求，客户端和文件的对象;以及锁定和共享数据的机制。通过一起使用浏览器端和服务器端脚本，可以在客户机和服务器之间分配计算机，同时为基于Web的应用程序提供定制的用户界面。

支持ECMAScript的每个Web浏览器和服务器都提供自己的主机环境，完成ECMAScript执行环境。

4.2 ECMAScript概述
以下是ECMAScript的非正式概述 - 不是描述所有的语言部分。这个概述不是标准的一部分。

ECMAScript是基于对象的：基本语言和主机设施由对象提供，ECMAScript程序是一组通信对象。在ECMAScript中，对象是零个或多个属性的集合，每个属性都具有确定每个属性可以如何使用的属性 - 例如，当属性的Writable属性设置为false时，执行的ECMAScript代码尝试分配不同的属性该属性的值失败。属性是容纳其他对象，原始值或函数的容器。原始值是以下内置类型之一的成员：Undefined，Null，Boolean，Number，String和Symbol;一个对象是内置类型Object的成员;一个函数是一个可调用对象。通过属性与对象关联的函数称为方法。

ECMAScript定义了一个内置对象的集合，从而整合了ECMAScript实体的定义。这些内置对象包括全局对象;对象，包括对象，函数，布尔，符号和各种错误对象的语言运行时语义的基础;表示和操作数值的对象，包括数学，数字和日期;文本处理对象String和RegExp;索引的值集合的对象包括Array和九种不同类型的类型数组，其元素都具有特定的数字数据表示;键集合，包括Map和Set对象;支持结构化数据的对象包括JSON对象，ArrayBuffer，SharedArrayBuffer和DataView;支持控制抽象的对象，包括生成器函数和Promise对象;和反射对象包括代理和反射。

ECMAScript还定义了一组内置运算符。 ECMAScript运算符包括各种一元运算，乘法运算符，加法运算符，按位移位运算符，关系运算符，等式运算符，二进制运算符，二进制逻辑运算符，赋值运算符和逗号运算符。

模块支持大型ECMAScript程序，这些模块允许将程序分为多个语句和声明序列。每个模块明确地标识它所使用的声明，这些声明需要由其他模块提供，哪些声明可供其他模块使用。

ECMAScript语法有意地类似于Java语法。 ECMAScript语法放松，使其成为易于使用的脚本语言。例如，一个变量不需要声明它的类型，也不是与属性相关联的类型，并且定义的函数在调用它们之前不需要以文本方式显示它们的声明。

4.2.1 对象
即使ECMAScript包含类定义的语法，ECMAScript对象也不是基于类的，如C ++，Smalltalk或Java中的。相反，对象可以以各种方式创建，包括通过文字符号或通过构造器创建对象，然后执行通过向其属性分配初始值来初始化其全部或部分的代码。每个构造函数都是一个名为“prototype”的属性，用于实现基于原型的继承和共享属性。通过使用新表达式中的构造函数创建对象;例如，新的Date（2009,11）创建一个新的Date对象。调用构造函数而不使用new会导致依赖于构造函数的后果。例如，Date（）产生当前日期和时间的字符串表示，而不是一个对象。

由构造函数创建的每个对象都有一个隐式引用（称为对象的原型）到其构造函数“prototype”属性的值。此外，原型可能具有对其原型的非空隐含引用，等等;这被称为原型链。当引用对象中的属性时，该引用是指原型链中包含该名称的属性的第一个对象中该名称的属性。换句话说，首先对直接提到的对象进行检查;如果该对象包含命名的属性，则该引用引用所引用的属性;如果该对象不包含named属性，那么将检查该对象的原型;等等。

图1：对象/原型关系

在基于类的面向对象语言中，一般来说，状态由实例承载，方法由类承载，继承只是结构和行为。在ECMAScript中，状态和方法由对象承载，而结构，行为和状态都是继承的。

所有不直接包含其原型包含共享该属性及其值的特定属性的对象。图1说明了这一点：

CF是一个构造函数（也是一个对象）。通过使用新的表达式创建了五个对象：cf1，cf2，cf3，cf4和cf5。这些对象都包含名为q1和q2的属性。虚线代表隐含的原型关系;所以，例如，cf3的原型是CFp。构造函数CF具有两个属性，名称为P1和P2，它们对于CFp，cf1，cf2，cf3，cf4或cf5是不可见的。在CFp中名为CFP1的属性由cf1，cf2，cf3，cf4和cf5共享（但不是由CF共享），CFp的隐式原型链中没有找到的属性未被命名为q1，q2或CFP1。注意CF和CFp之间没有隐式的原型链接。

与大多数基于类的对象语言不同，属性可以通过为对象动态分配值来添加到对象中。也就是说，构造函数不需要为所有或任何构造的对象的属性命名或赋值。在上图中，可以通过向CFp中的属性分配一个新值，为cf1，cf2，cf3，cf4和cf5添加一个新的共享属性。

虽然ECMAScript对象本身并不是基于类的，但是通常可以根据构造函数，原型对象和方法的常见模式定义类类抽象。 ECMAScript内置对象本身就像这样的类似样式。 ECMAScript 2015开始，ECMAScript语言包括语法类定义，允许程序员简洁地定义符合内置对象使用的类似类的抽象模式的对象。

4.2.2 ECMAScript的严格变体
ECMAScript语言识别该语言的某些用户可能希望限制其使用该语言中可用的某些功能的可能性。为了安全起见，他们可能会这样做，以避免他们认为是容易出错的功能，加强错误检查或其他选择原因。为了支持这种可能性，ECMAScript定义了语言的严格变体。该语言的严格变体排除了常规ECMAScript语言的一些特定句法和语义特征，并修改了某些功能的详细语义。严格变体还指定了额外的错误条件，必须通过在不严格的语言形式指定为错误的情况下抛出错误异常来报告错误。

ECMAScript的严格变体通常被称为语言的严格模式。 ECMAScript的严格模式选择和使用严格模式语法和语义明确地在单个ECMAScript源文本单元的级别。因为在句法源文本单元的级别选择了严格模式，严格模式只会在这样的源文本单元中施加具有局部效果的限制。严格模式不会限制或修改必须在多个源文本单元上一致操作的ECMAScript语义的任何方面。完整的ECMAScript程序可能由严格模式和非严格模式ECMAScript源文本单元组成。在这种情况下，严格模式仅在实际执行在严格模式源文本单元中定义的代码时适用。

为了符合本规范，ECMAScript实现必须实现完全无限制的ECMAScript语言和本规范定义的ECMAScript语言的严格变体。此外，实现必须支持将无限制和严格模式源文本单元组合到单个复合程序中。

4.3条款和定义
为了本文档的目的，适用以下术语和定义。

4.3.1型
本规范第6条定义的一组数据值

4.3.2主要价值
类型之一的成员Undefined，Null，Boolean，Number，Symbol或String，如第6节所定义

注意
原始值是直接在语言实现的最低级别表示的基准。
4.3.3对象
Object类型的成员

注意
对象是属性的集合，并且具有单个原型对象。原型可能是空值。
4.3.4构造函数
创建和初始化对象的函数对象

注意
构造函数的prototype属性的值是用于实现继承和共享属性的原型对象。
4.3.5原型
为其他对象提供共享属性的对象

注意
当构造函数创建一个对象时，该对象隐式引用构造函数的prototype属性，以便解析属性引用。构造函数的prototype属性可以由程序表达式constructor.prototype引用，并且添加到对象的原型中的属性通过继承由共享原型的所有对象进行共享。或者，可以使用Object.create内置函数通过明确指定的原型创建一个新对象。
4.3.6对象
对象具有所有对象必须支持的基本内部方法的默认行为

4.3.7异国情调
对象不具有一个或多个必要内部方法的默认行为

注意
任何不是普通对象的对象都是异乎寻常的对象。
4.3.8标准对象
其语义由本规范定义的对象

4.3.9内置对象
由ECMAScript实现指定和提供的对象

注意
标准内置对象在本规范中定义。 ECMAScript实现可以指定和提供其他种类的内置对象。内置的构造函数是一个内置对象，也是一个构造函数。
4.3.10未定义值
当变量未被赋值时使用的原始值

4.3.11未定义类型
类型，其唯一值是未定义的值

4.3.12空值
表示有意不存在任何对象值的原始值

4.3.13空型
其唯一值为空值的类型

4.3.14布尔值
布尔类型的成员

注意
只有两个布尔值为true和false。
4.3.15布尔类型
类型由原始值true和false组成

4.3.16布尔对象
作为标准内置布尔构造函数实例的Object类型的成员

注意
通过在新表达式中使用布尔构造函数创建一个布尔对象，提供布尔值作为参数。生成的对象具有一个内部插槽，其值为布尔值。一个布尔对象可以强制为一个布尔值。
4.3.17定值
原始值是零个或多个16位无符号整数值的有限序列

注意
String值是String类型的成员。序列中的每个整数值通常表示UTF-16文本的单个16位单位。但是，ECMAScript对值不作任何限制或要求，除了它们必须是16位无符号整数。
4.3.18String类型
所有可能的字符串值的集合

4.3.19引用对象
作为标准内置String构造函数实例的Object类型的成员

注意
通过在新表达式中使用String构造函数创建String对象，将String值作为参数提供。生成的对象具有一个内部插槽，其值为String值。通过调用String构造函数作为函数，可以将String对象强制转换为String值（21.1.1.1）。
4.3.20数值
原始值对应于双精度64位二进制格式IEEE 754-2008值

注意
数字值是数字类型的成员，是数字的直接表示形式。
4.3.21数字类型
包括所有可能的数字值，包括特殊的“非数字”（NaN）值，正无穷大和负无穷大

4.3.22数值对象
Object类型的成员，它是标准内置Number构造函数的一个实例

注意
通过在新表达式中使用Number构造函数创建Number对象，提供数值作为参数。生成的对象具有一个内部插槽，其值是数字值。可以通过调用Number构造函数作为函数（20.1.1.1），将Number对象强制转换为数值。
4.3.23无限
数值是正数无限数值

4.3.24NaN
数字值是IEEE 754-2008“非数字”值

4.3.25符号值
表示唯一的非String对象属性键的原始值

4.3.26符号型
所有可能的符号值的集合

4.3.27符号对象
作为标准内置Symbol构造函数实例的Object类型的成员

4.3.28功能
可以作为子例程调用的Object类型的成员

注意
除了其属性之外，函数还包含可执行代码和状态，以确定调用时的行为方式。函数的代码可能会被写入到ECMAScript中。
4.3.29内置功能
内置对象是一个函数

注意
内置函数的示例包括parseInt和Math.exp。实现可以提供在本说明书中未描述的实现相关的内置功能。
4.3.30属性
将一个关键字（一个String值或一个Symbol值）和一个值相关联的对象的一部分

注意
根据属性的形式，该值可以直接表示为数据值（原始值，对象或函数对象）或由一对访问器函数间接表示。
4.3.31方法
函数是属性的值

注意
当函数被调用为对象的方法时，该对象将作为其值传递给该函数。
4.3.32内置方法
方法是内置函数

注意
标准内置方法在本规范中定义，ECMAScript实现可以指定并提供其他额外的内置方法。
4.3.33属性
定义属性某些特性的内部值

4.3.34自有财产
由其对象直接包含的属性

4.3.35继承属性
属性不属于自己的属性，但是对象的原型的属性（自己的或继承的）

4.4机关
规范本规范的其余部分组织如下：条款5定义了整个规范中使用的符号约定。 第6-9条定义ECMAScript程序运行的执行环境。 第10-16条定义了实际的ECMAScript编程语言，包括其语法编码和所有语言特征的执行语义。 第17-26条定义了ECMAScript标准库。 它们包括ECMAScript程序执行时可以使用的所有标准对象的定义。